# «Грязные дела»

## Описание проекта
Алгоритмы компьютерного зрения решают много задач на наших производствах. Если линза камеры загрязнена, то точность и корректность работы алгоритмов может очень сильно снизиться. Поэтому необходимо решение, отслеживающее загрязнение линз.
Цель данного кейса – создать решение, которое сможет определять фактзагрязнения камеры. 

Этот проект реализует сегментацию изображений с использованием модифицированной модели U-Net с механизмами внимания (Attention Gates). Основные возможности включают:

- **Обработка и подготовка данных**: загрузка и обработка реальных данных, генерация синтетических изображений и масок.
- **Аугментации данных**: использование библиотеки Albumentations для улучшения качества данных.
- **Модель**: модифицированная архитектура U-Net с добавлением Attention Gate для улучшения сегментации.
- **Обучение и валидация**: обучение модели, сохранение лучших весов и оценка качества сегментации.
- **Визуализация результатов**: наглядное отображение предсказаний модели.

## Структура проекта

- **Данные**:
  - `train_dataset/cv_open_dataset/open_img`: папка с реальными изображениями.
  - `train_dataset/cv_open_dataset/open_msk`: папка с реальными масками.
  - `train_dataset/cv_synt_dataset`: папка для сохранения синтетических данных.
- **Модель**:
  - Реализована в классе `LiteUNetWithAttention`.
- **Обработка данных**:
  - Генерация синтетических данных с использованием модуля `raindrop`.
  - Аугментации с помощью библиотеки Albumentations.

## Использование

### 1. Подготовка данных

- Скачайте и распакуйте датасет.
- Запустите блокнот `NN_cv_u-net.ipynb`.


### 2. Обучение модели

- Лучшая модель будет сохранена как `unet4_best_updated_weights.pth`.

### 3. Инференс

- Упакуйте `infer_by_test.py` вместе с моделью и `metadata.json` в архив и загрузите на сервер.

## Основные зависимости

- Python 3.9+
- PyTorch
- Albumentations
- OpenCV
- scikit-learn
- Matplotlib
- tqdm

## Визуализация

В проекте предусмотрена визуализация:

1. **Пример данных**: отображение изображений и их масок.
2. **Графики обучения**: метрики `Loss` и `mIoU` для тренировки и валидации.
3. **Предсказания модели**: сравнение исходных изображений, истинных и предсказанных масок.

## Команда Stepwalker

- [Ермолаева Саргылана](https://github.com/sargylana108/) — DS-разработчик
- [Дудинский Юлиус](https://github.com/ddnsky/) — DS-разработчик

